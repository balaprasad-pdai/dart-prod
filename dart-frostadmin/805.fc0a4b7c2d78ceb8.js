"use strict";(self.webpackChunkskote=self.webpackChunkskote||[]).push([[805],{54805:(mt,D,u)=>{u.r(D),u.d(D,{ReportsModule:()=>v});var g=u(36895),q=u(85892),_=u(15861),x=u(61135),O=u(77579),M=u(39646),I=u(18505),R=u(78372),N=u(63900),B=u(91005),t=u(94650),$=u(80529),J=u(6162);class h{constructor(e,s,d){this.pipe=e,this.http=s,this.util=d,this._loading$=new x.X(!0),this._search$=new O.x,this._filteredData$=new x.X([]),this._total$=new x.X(0),this._state={page:1,pageSize:8,searchTerm:"",sortColumn:"",sortDirection:"",startIndex:0,endIndex:9,totalRecords:0,status:"",payment:"",date:""},this.cities=[{id:1,name:"Kannur",state:"Kerala"},{id:2,name:"Kochi",state:"Kerala"},{id:3,name:"Chalakudi",state:"Kerala"}],this.getOrders=()=>(this.util.activeUrl=2,this.http.get("/api/order",{headers:void 0})),this._search$.pipe((0,I.b)(()=>this._loading$.next(!0)),(0,R.b)(200),(0,N.w)(()=>this._search()),(0,B.g)(200),(0,I.b)(()=>this._loading$.next(!1))).subscribe(r=>{this._filteredData$.next(r.filteredData),this._total$.next(r.total)}),this._search$.next()}get filteredData$(){return this._filteredData$.asObservable()}get product(){return this.products}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get page(){return this._state.page}get pageSize(){return this._state.pageSize}get searchTerm(){return this._state.searchTerm}get startIndex(){return this._state.startIndex}get endIndex(){return this._state.endIndex}get totalRecords(){return this._state.totalRecords}get status(){return this._state.status}get payment(){return this._state.payment}get date(){return this._state.date}set page(e){this._set({page:e})}set pageSize(e){this._set({pageSize:e})}set searchTerm(e){this._set({searchTerm:e})}set sortColumn(e){this._set({sortColumn:e})}set sortDirection(e){this._set({sortDirection:e})}set startIndex(e){this._set({startIndex:e})}set endIndex(e){this._set({endIndex:e})}set totalRecords(e){this._set({totalRecords:e})}set status(e){this._set({status:e})}set payment(e){this._set({payment:e})}set date(e){this._set({date:e})}_set(e){Object.assign(this._state,e),this._search$.next()}_search(){const{sortColumn:e,sortDirection:s,page:r,searchTerm:n}=this._state;let c=function E(i,e,s){return""===s||""===e?i:[...i].sort((d,r)=>{const n=((i,e)=>i<e?-1:i>e?1:0)(d[e],r[e]);return"asc"===s?n:-n})}(this.cities,e,s);c=c.filter(f=>function j(i,e,s){return i.name.toLowerCase().includes(e.toLowerCase())}(f,n));const p=c.length;return this.totalRecords=c.length,this._state.startIndex=(r-1)*this.pageSize+1,this._state.endIndex=(r-1)*this.pageSize+this.pageSize,this.endIndex>this.totalRecords&&(this.endIndex=this.totalRecords),c=c.slice(this._state.startIndex-1,this._state.endIndex),(0,M.of)({filteredData:c,total:p})}}h.\u0275fac=function(e){return new(e||h)(t.LFG(g.JJ),t.LFG($.eN),t.LFG(J.f))},h.\u0275prov=t.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"});var b=u(68840),z=u(31545),T=u(80574),C=u(94327),L=u(32521),w=u(29234),S=u(18987);function K(i,e){1&i&&t._UZ(0,"app-loader")}function V(i,e){1&i&&(t.ynx(0),t.TgZ(1,"tr")(2,"td",20),t._uU(3,"No Bookings list."),t.qZA()(),t.BQk())}function X(i,e){1&i&&(t.TgZ(0,"span",26),t._uU(1,"Payment completed"),t.qZA())}function G(i,e){1&i&&(t.TgZ(0,"span",27),t._uU(1,"Rejected"),t.qZA())}function W(i,e){1&i&&(t.TgZ(0,"span",28),t._uU(1,"Order approved"),t.qZA())}function H(i,e){1&i&&(t.TgZ(0,"span",29),t._uU(1,"Staff assigned"),t.qZA())}function tt(i,e){1&i&&(t.TgZ(0,"span",30),t._uU(1,"Awaiting confirmation"),t.qZA())}function et(i,e){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"date"),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.qZA(),t.TgZ(18,"td"),t.YNc(19,X,2,0,"span",21),t.YNc(20,G,2,0,"span",22),t.YNc(21,W,2,0,"span",23),t.YNc(22,H,2,0,"span",24),t.YNc(23,tt,2,0,"span",25),t.qZA()()),2&i){const s=e.$implicit,d=e.index,r=t.oxw();t.xp6(2),t.Oqu((r.currentPage-1)*r.itemsPerPage+d+1),t.xp6(2),t.Oqu(null==s||null==s.orderMeta||null==s.orderMeta.address?null:s.orderMeta.address.name),t.xp6(2),t.Oqu(r.getData(null==s?null:s.userId,"customer")),t.xp6(2),t.Oqu(null==s||null==s.orderMeta||null==s.orderMeta.vehicleData?null:s.orderMeta.vehicleData.name),t.xp6(2),t.Oqu(r.getPackages(null==s||null==s.orderMeta?null:s.orderMeta.package)),t.xp6(2),t.Oqu(t.xi3(13,13,null==s?null:s.createdAt,"longDate")),t.xp6(3),t.Oqu(r.getRoundOff(null==s?null:s.paymentTotal)),t.xp6(2),t.Oqu(r.getData(null==s?null:s.staffId,"staff")),t.xp6(2),t.Q6J("ngIf","approved"===s.status&&s.paymentStatus),t.xp6(1),t.Q6J("ngIf","rejected"===s.status),t.xp6(1),t.Q6J("ngIf","approved"===s.status&&!s.staffId&&!s.paymentStatus),t.xp6(1),t.Q6J("ngIf","approved"===s.status&&s.staffId&&!s.paymentStatus),t.xp6(1),t.Q6J("ngIf","awaiting-confirmation"===s.status)}}class y{constructor(e,s,d,r){var n=this;this.service=e,this.userService=s,this.staffService=d,this.datePipe=r,this.bookingsList=[],this.staffsList=[],this.usersList=[],this.slicedBookingList=[],this.itemsPerPage=10,this.showLoader=!1,this.currentPage=1,this.loadBookings=(0,_.Z)(function*(){try{const a=yield n.service.getOrders().toPromise();a&&(n.bookingsList=a,n.bookingsList=a.sort((l,o)=>o.id-l.id),n.slicedBookingList=n.bookingsList.slice(0,n.itemsPerPage),n.usersList.length&&n.staffsList.length&&(n.showLoader=!1))}catch{n.showLoader=!1}}),this.loadUsers=(0,_.Z)(function*(){try{const a=yield n.userService.getUsers().toPromise();a&&(n.usersList=a,n.bookingsList.length&&n.staffsList.length&&(n.showLoader=!1))}catch{n.showLoader=!1}}),this.loadStaffs=(0,_.Z)(function*(){try{const a=yield n.staffService.getAllStaffs("staff").toPromise();a&&(n.staffsList=a,n.usersList.length&&n.bookingsList.length&&(n.showLoader=!1))}catch{n.showLoader=!1}}),this.getAtob=a=>a?atob(a):"-",this.getData=(a,l)=>{let o=[];return"customer"==l?(o=this.usersList.filter(c=>c.id==a),o.length?this.getAtob(o[0].username):"-"):"staff"==l?(o=this.staffsList.filter(c=>c.id==a),o.length?o[0].name:"-"):void 0},this.getPackages=a=>{let l="";return a?.forEach((o,c)=>{l+=c<a.length-1?o.name+", ":o.name}),l},this.exportExcel=a=>{const l=this.structureExcelDownloadData();if(l){const o=T.P6.json_to_sheet(l);o["!cols"]=[{wpx:130},{wpx:130},{wpx:90},{wpx:130},{wpx:90},{wpx:130},{wpx:130},{wpx:130}];const p=T.cW({Sheets:{data:o},SheetNames:["data"]},{bookType:"xlsx",type:"array"});this.saveAsExcelFile(p,a)}else console.warn("Excel data is Null")},this.structureExcelDownloadData=()=>{let a=[];return this.slicedBookingList.map(o=>{a.push({"Customer Name":o?.orderMeta?.address?.name,"Customer No":this.getData(o?.userId,"customer"),Vehicle:o?.orderMeta?.vehicleData?.name,Service:this.getPackages(o?.orderMeta?.package),"Booking Date":o?.createdAt?this.datePipe.transform(o.createdAt,"dd MMMM, yyyy"):"",Amount:this.getRoundOff(o?.paymentTotal),"Assigned staff":this.getData(o?.staffId,"staff"),Status:this.getStatus(o)})}),0!==a.length?a:null},this.saveAsExcelFile=(a,l)=>{const o=l||"",f=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});C.saveAs(f,`${o}.xlsx`)},this.changePage=a=>{this.currentPage=a.page,this.slicedBookingList=this.bookingsList.slice((a.page-1)*a.itemsPerPage,a.page*a.itemsPerPage)},this.getStatus=a=>"approved"===a.status&&a.paymentStatus?"Payment completed":"rejected"===a.status?"Rejected":"approved"!==a.status||a.staffId||a.paymentStatus?"approved"===a.status&&a.staffId&&!a.paymentStatus?"Staff assigned":"awaiting-confirmation"===a.status?"Awaiting confirmation":void 0:"Order approved",this.getRoundOff=a=>Math.round(100*a)/100,this.total=e.total$}ngOnInit(){this.showLoader=!0,this.breadCrumbItems=[{label:"Reports"},{label:"Booking Reports",active:!0}],this.loadBookings(),this.loadUsers(),this.loadStaffs()}}y.\u0275fac=function(e){return new(e||y)(t.Y36(h),t.Y36(b.f),t.Y36(z.q),t.Y36(g.uU))},y.\u0275cmp=t.Xpm({type:y,selectors:[["app-bookings"]],features:[t._Bn([h,g.JJ,g.uU,z.q,b.f])],decls:41,vars:6,consts:[[4,"ngIf"],[1,"container-fluid"],["title","Booking Reports",3,"breadcrumbItems"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],[1,"col-sm-4"],[1,"col-sm-8"],[1,"text-sm-end"],["type","button",1,"btn","btn-success","btn-rounded","mb-2","me-2",3,"click"],[1,"mdi","mdi-plus","mr-1"],[1,"table-responsive","mb-0"],[1,"table","table-centered","table-nowrap"],[1,"table"],[1,"align-middle"],[4,"ngFor","ngForOf"],[1,"pagination","pagination-rounded","justify-content-end","mb-2"],[3,"totalItems","itemsPerPage","pageChanged"],["colspan","9",1,"text-center"],["class","badge badge-pill badge-soft-secondary font-size-11",4,"ngIf"],["class","badge badge-pill badge-soft-danger font-size-11",4,"ngIf"],["class","badge badge-pill badge-soft-warning font-size-11",4,"ngIf"],["class","badge badge-pill badge-soft-success font-size-11",4,"ngIf"],["class","badge badge-pill badge-soft-info font-size-11",4,"ngIf"],[1,"badge","badge-pill","badge-soft-secondary","font-size-11"],[1,"badge","badge-pill","badge-soft-danger","font-size-11"],[1,"badge","badge-pill","badge-soft-warning","font-size-11"],[1,"badge","badge-pill","badge-soft-success","font-size-11"],[1,"badge","badge-pill","badge-soft-info","font-size-11"]],template:function(e,s){1&e&&(t.YNc(0,K,1,0,"app-loader",0),t.TgZ(1,"div",1),t._UZ(2,"app-page-title",2),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t._UZ(8,"div",8),t.TgZ(9,"div",9)(10,"div",10)(11,"button",11),t.NdJ("click",function(){return s.exportExcel("Bookings List")}),t._UZ(12,"i",12),t._uU(13," Export "),t.qZA()()()(),t.TgZ(14,"div",13)(15,"table",14)(16,"thead",15)(17,"tr")(18,"th",16),t._uU(19,"Sl. No."),t.qZA(),t.TgZ(20,"th",16),t._uU(21,"Customer Name"),t.qZA(),t.TgZ(22,"th",16),t._uU(23,"Customer No."),t.qZA(),t.TgZ(24,"th",16),t._uU(25,"Vehicle"),t.qZA(),t.TgZ(26,"th",16),t._uU(27,"Service"),t.qZA(),t.TgZ(28,"th",16),t._uU(29,"Booking date"),t.qZA(),t.TgZ(30,"th",16),t._uU(31,"Amount"),t.qZA(),t.TgZ(32,"th",16),t._uU(33,"Assigned Staff"),t.qZA(),t.TgZ(34,"th",16),t._uU(35,"Status"),t.qZA()()(),t.TgZ(36,"tbody"),t.YNc(37,V,4,0,"ng-container",0),t.YNc(38,et,24,16,"tr",17),t.qZA()()(),t.TgZ(39,"ul",18)(40,"pagination",19),t.NdJ("pageChanged",function(r){return s.changePage(r)}),t.qZA()()()()()()()),2&e&&(t.Q6J("ngIf",s.showLoader),t.xp6(2),t.Q6J("breadcrumbItems",s.breadCrumbItems),t.xp6(35),t.Q6J("ngIf",!(null!=s.slicedBookingList&&s.slicedBookingList.length)),t.xp6(1),t.Q6J("ngForOf",s.slicedBookingList),t.xp6(2),t.Q6J("totalItems",s.bookingsList.length)("itemsPerPage",s.itemsPerPage))},dependencies:[g.sg,g.O5,L.Qt,w.V,S.R,g.uU]});var F=u(32620),k=u(24006);function st(i,e){1&i&&t._UZ(0,"app-loader")}function at(i,e){1&i&&(t.ynx(0),t.TgZ(1,"tr")(2,"td",20),t._uU(3," No Transactions list. "),t.qZA()(),t.BQk())}function nt(i,e){if(1&i&&(t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"date"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.qZA()()),2&i){const s=e.$implicit,d=e.index,r=t.oxw();t.xp6(2),t.Oqu((r.currentPage-1)*r.itemsPerPage+d+1),t.xp6(2),t.Oqu(null==s||null==s.orderMeta||null==s.orderMeta.address?null:s.orderMeta.address.name),t.xp6(2),t.Oqu(r.getData(null==s?null:s.userId,"customer")),t.xp6(2),t.Oqu(r.utilService.getOrderId(null==s?null:s.id)),t.xp6(2),t.hij("#",r.utilService.getOrderId(null==s?null:s.id),""),t.xp6(2),t.hij(" ",null!=s&&null!=s.orderMeta&&s.orderMeta.preferredPaymentMethod?null==s||null==s.orderMeta?null:s.orderMeta.preferredPaymentMethod:"-"," "),t.xp6(2),t.hij(" ",t.xi3(15,8,null==s||null==s.timeline[3]?null:s.timeline[3].updationTime,"longDate")," "),t.xp6(3),t.Oqu(r.getRoundOff(null==s?null:s.paymentTotal))}}class U{constructor(e,s,d,r){var n=this;this.service=e,this.userService=s,this.datePipe=d,this.utilService=r,this.showLoader=!1,this.data=[{slNo:"1",id:1,name:"akhil",orderid:"12335",transactionid:"2325",paymenttype:"cash",amount:"3000",status:"Payment completed"},{slNo:"2",id:2,name:"athul",orderid:"12330",transactionid:"2321",paymenttype:"-",amount:"5000",status:"Payment-pending"},{slNo:"3",id:3,name:"amal",orderid:"12331",transactionid:"2328",paymenttype:"-",amount:"8000",status:"Payment-pending"}],this.roles=[{name:"Admin"},{name:"Super Admin"},{name:"Sub Admin"}],this.transactionsList=[],this.slicedTransactionsList=[],this.usersList=[],this.loadTransactionsList=(0,_.Z)(function*(){n.itemsPerPage=10,n.currentPage=1;try{const a=yield n.service.getPaymentCompletedOrders().toPromise();a&&(n.transactionsList=a.sort((l,o)=>Number(new Date(o.timeline[3]?.updationTime).getTime())-Number(new Date(l?.timeline[3]?.updationTime).getTime())),n.slicedTransactionsList=n.transactionsList.slice(0,n.itemsPerPage),n.usersList.length&&(n.showLoader=!1))}catch{n.showLoader=!1}}),this.exportExcel=a=>{const l=this.structureExcelDownloadData();if(l){const o=T.P6.json_to_sheet(l);o["!cols"]=[{wpx:130},{wpx:130},{wpx:90},{wpx:90},{wpx:130},{wpx:130}];const p=T.cW({Sheets:{data:o},SheetNames:["data"]},{bookType:"xlsx",type:"array"});this.saveAsExcelFile(p,a)}else console.warn("Excel data is Null")},this.structureExcelDownloadData=()=>{let a=[];return this.slicedTransactionsList.map(o=>{a.push({"Customer name":o?.orderMeta?.address?.name,"Customer Phone":this.getData(o?.userId,"customer"),"Order Id":this.utilService.getOrderId(o?.id),"Transaction Id":"#"+this.utilService.getOrderId(o?.id),"Preffered Payment Method":o?.orderMeta?.preferredPaymentMethod?o?.orderMeta?.preferredPaymentMethod:"-","Payment Date":o?.timeline[3]?.updationTime?this.datePipe.transform(o?.timeline[3]?.updationTime,"dd MMMM, yyyy"):"",Amount:this.getRoundOff(o?.paymentTotal)})}),0!==a.length?a:null},this.saveAsExcelFile=(a,l)=>{const o=l||"",f=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});C.saveAs(f,`${o}.xlsx`)},this.changePage=a=>{this.currentPage=a.page,this.slicedTransactionsList=this.transactionsList.slice((a.page-1)*a.itemsPerPage,a.page*a.itemsPerPage)},this.loadUsers=(0,_.Z)(function*(){try{const a=yield n.userService.getUsers().toPromise();a&&(n.usersList=a,n.transactionsList.length&&(n.showLoader=!1))}catch{n.showLoader=!1}}),this.getAtob=a=>a?atob(a):"-",this.getData=(a,l)=>{let o=[];if("customer"==l)return o=this.usersList.filter(c=>c.id==a),o.length?this.getAtob(o[0].username):"-"},this.getRoundOff=a=>Math.round(100*a)/100,this.total=e.total$}ngOnInit(){this.showLoader=!0,this.breadCrumbItems=[{label:"Reports"},{label:"Transaction Reports",active:!0}],this.loadTransactionsList(),this.loadUsers()}}let A;U.\u0275fac=function(e){return new(e||U)(t.Y36(F.p),t.Y36(b.f),t.Y36(g.uU),t.Y36(J.f))},U.\u0275cmp=t.Xpm({type:U,selectors:[["app-transactions"]],features:[t._Bn([F.p,g.JJ,b.f,g.uU])],decls:39,vars:7,consts:[[4,"ngIf"],[1,"container-fluid"],["title","Transaction Reports",3,"breadcrumbItems"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],[1,"col-sm-4"],[1,"col-sm-8"],[1,"text-sm-end"],["type","button",1,"btn","btn-success","btn-rounded","mb-2","me-2",3,"click"],[1,"mdi","mdi-plus","mr-1"],[1,"table-responsive","mb-0"],[1,"table","table-centered","table-nowrap"],[1,"table"],[1,"align-middle"],[4,"ngFor","ngForOf"],[1,"pagination","pagination-rounded","justify-content-end","mb-2"],[3,"totalItems","itemsPerPage","ngModel","ngModelChange","pageChanged"],["colspan","8",1,"text-center"]],template:function(e,s){1&e&&(t.YNc(0,st,1,0,"app-loader",0),t.TgZ(1,"div",1),t._UZ(2,"app-page-title",2),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t._UZ(8,"div",8),t.TgZ(9,"div",9)(10,"div",10)(11,"button",11),t.NdJ("click",function(){return s.exportExcel("Transactions List")}),t._UZ(12,"i",12),t._uU(13," Export "),t.qZA()()()(),t.TgZ(14,"div",13)(15,"table",14)(16,"thead",15)(17,"tr")(18,"th",16),t._uU(19,"Sl. No."),t.qZA(),t.TgZ(20,"th",16),t._uU(21,"Customer Name"),t.qZA(),t.TgZ(22,"th",16),t._uU(23,"Customer Phone"),t.qZA(),t.TgZ(24,"th",16),t._uU(25,"Order Id"),t.qZA(),t.TgZ(26,"th",16),t._uU(27,"Transaction Id"),t.qZA(),t.TgZ(28,"th",16),t._uU(29,"Preffered Payment Method"),t.qZA(),t.TgZ(30,"th",16),t._uU(31,"Payment date"),t.qZA(),t.TgZ(32,"th",16),t._uU(33,"Amount"),t.qZA()()(),t.TgZ(34,"tbody"),t.YNc(35,at,4,0,"ng-container",0),t.YNc(36,nt,18,11,"tr",17),t.qZA()()(),t.TgZ(37,"ul",18)(38,"pagination",19),t.NdJ("ngModelChange",function(r){return s.currentPage=r})("pageChanged",function(r){return s.changePage(r)}),t.qZA()()()()()()()),2&e&&(t.Q6J("ngIf",s.showLoader),t.xp6(2),t.Q6J("breadcrumbItems",s.breadCrumbItems),t.xp6(33),t.Q6J("ngIf",!(null!=s.slicedTransactionsList&&s.slicedTransactionsList.length)),t.xp6(1),t.Q6J("ngForOf",s.slicedTransactionsList),t.xp6(2),t.Q6J("totalItems",s.transactionsList.length)("itemsPerPage",s.itemsPerPage)("ngModel",s.currentPage))},dependencies:[g.sg,g.O5,L.Qt,k.JJ,k.On,w.V,S.R,g.uU]});class m{constructor(e,s){this.pipe=e,this.http=s,this._loading$=new x.X(!0),this._search$=new O.x,this._filteredData$=new x.X([]),this._total$=new x.X(0),this._state={page:1,pageSize:8,searchTerm:"",sortColumn:"",sortDirection:"",startIndex:0,endIndex:9,totalRecords:0,status:"",payment:"",date:""},this.cities=[{id:1,name:"Kannur",state:"Kerala"},{id:2,name:"Kochi",state:"Kerala"},{id:3,name:"Chalakudi",state:"Kerala"}],this.saveCity=d=>this.http.post("/api/city",d,{headers:A}),this.getCities=()=>this.http.get("/api/city",{headers:A}),this.deleteCity=d=>this.http.delete(`/api/city/${d}`,{headers:A}),this.getSelectedCityDetail=d=>this.http.get(`/api/city/${d}`,{headers:A}),this.updateCityDetail=(d,r)=>this.http.patch(`/api/city/${r}`,d,{headers:A}),this._search$.pipe((0,I.b)(()=>this._loading$.next(!0)),(0,R.b)(200),(0,N.w)(()=>this._search()),(0,B.g)(200),(0,I.b)(()=>this._loading$.next(!1))).subscribe(d=>{this._filteredData$.next(d.filteredData),this._total$.next(d.total)}),this._search$.next()}get filteredData$(){return this._filteredData$.asObservable()}get product(){return this.products}get total$(){return this._total$.asObservable()}get loading$(){return this._loading$.asObservable()}get page(){return this._state.page}get pageSize(){return this._state.pageSize}get searchTerm(){return this._state.searchTerm}get startIndex(){return this._state.startIndex}get endIndex(){return this._state.endIndex}get totalRecords(){return this._state.totalRecords}get status(){return this._state.status}get payment(){return this._state.payment}get date(){return this._state.date}set page(e){this._set({page:e})}set pageSize(e){this._set({pageSize:e})}set searchTerm(e){this._set({searchTerm:e})}set sortColumn(e){this._set({sortColumn:e})}set sortDirection(e){this._set({sortDirection:e})}set startIndex(e){this._set({startIndex:e})}set endIndex(e){this._set({endIndex:e})}set totalRecords(e){this._set({totalRecords:e})}set status(e){this._set({status:e})}set payment(e){this._set({payment:e})}set date(e){this._set({date:e})}_set(e){Object.assign(this._state,e),this._search$.next()}_search(){const{sortColumn:e,sortDirection:s,page:r,searchTerm:n}=this._state;let c=function ot(i,e,s){return""===s||""===e?i:[...i].sort((d,r)=>{const n=((i,e)=>i<e?-1:i>e?1:0)(d[e],r[e]);return"asc"===s?n:-n})}(this.cities,e,s);c=c.filter(f=>function rt(i,e,s){return i.name.toLowerCase().includes(e.toLowerCase())}(f,n));const p=c.length;return this.totalRecords=c.length,this._state.startIndex=(r-1)*this.pageSize+1,this._state.endIndex=(r-1)*this.pageSize+this.pageSize,this.endIndex>this.totalRecords&&(this.endIndex=this.totalRecords),c=c.slice(this._state.startIndex-1,this._state.endIndex),(0,M.of)({filteredData:c,total:p})}}function lt(i,e){1&i&&t._UZ(0,"app-loader")}function dt(i,e){1&i&&(t.ynx(0),t.TgZ(1,"tr")(2,"td",21),t._uU(3,"No Users list."),t.qZA()(),t.BQk())}function ct(i,e){1&i&&(t.TgZ(0,"div",25),t._uU(1," Verified "),t.qZA())}function ut(i,e){1&i&&(t.TgZ(0,"div",26),t._uU(1," Unverified "),t.qZA())}function gt(i,e){if(1&i&&(t.ynx(0),t.TgZ(1,"tr")(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td"),t._uU(9),t.ALo(10,"date"),t.qZA(),t.TgZ(11,"td")(12,"div",22),t.YNc(13,ct,2,0,"div",23),t.YNc(14,ut,2,0,"div",24),t.qZA()()(),t.BQk()),2&i){const s=e.$implicit,d=e.index,r=t.oxw();t.xp6(3),t.Oqu((r.currentPage-1)*r.itemsPerPage+d+1),t.xp6(2),t.hij(" ",null==s?null:s.name," "),t.xp6(2),t.Oqu(r.getAtob(null==s?null:s.username)),t.xp6(2),t.Oqu(t.xi3(10,6,null==s?null:s.createdAt,"longDate")),t.xp6(4),t.Q6J("ngIf",1==(null==s?null:s.verified)),t.xp6(1),t.Q6J("ngIf",0==(null==s?null:s.verified))}}m.\u0275fac=function(e){return new(e||m)(t.LFG(g.JJ),t.LFG($.eN))},m.\u0275prov=t.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"});class P{constructor(e,s,d){var r=this;this.usersService=e,this.service=s,this.datePipe=d,this.slicedUsersList=[],this.showLoader=!1,this.roles=[{name:"Admin"},{name:"Super Admin"},{name:"Sub Admin"}],this.usersList=[],this.itemsPerPage=10,this.currentPage=1,this.loadUsers=(0,_.Z)(function*(){try{const n=yield r.usersService.getUsers().toPromise();n&&(r.usersList=n,r.slicedUsersList=r.usersList.slice(0,r.itemsPerPage),r.showLoader=!1)}catch{r.showLoader=!1}}),this.getAtob=n=>n?atob(n):"-",this.changePage=n=>{this.currentPage=n.page,this.slicedUsersList=this.usersList.slice((n.page-1)*n.itemsPerPage,n.page*n.itemsPerPage)},this.exportExcel=n=>{const a=this.structureExcelDownloadData();if(a){const l=T.P6.json_to_sheet(a);l["!cols"]=[{wpx:130},{wpx:90},{wpx:130},{wpx:90},{wpx:130},{wpx:130}];const c=T.cW({Sheets:{data:l},SheetNames:["data"]},{bookType:"xlsx",type:"array"});this.saveAsExcelFile(c,n)}else console.warn("Excel data is Null")},this.structureExcelDownloadData=()=>{let n=[];return this.slicedUsersList.map(l=>{n.push({"User Name":l.name,"Contact Number":this.getAtob(l?.username),"Register Date":l.createdAt?this.datePipe.transform(l.createdAt,"dd MMMM, yyyy"):"",Verified:l.verified?"Verified":"Unverified"})}),0!==n.length?n:null},this.saveAsExcelFile=(n,a)=>{const l=a||"",p=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});C.saveAs(p,`${l}.xlsx`)},this.total=s.total$}ngOnInit(){this.showLoader=!0,this.breadCrumbItems=[{label:"Reports"},{label:"User Reports",active:!0}],this.loadUsers()}}P.\u0275fac=function(e){return new(e||P)(t.Y36(b.f),t.Y36(m),t.Y36(g.uU))},P.\u0275cmp=t.Xpm({type:P,selectors:[["app-users"]],features:[t._Bn([b.f,g.JJ,g.uU,m])],decls:33,vars:6,consts:[[4,"ngIf"],[1,"container-fluid"],["title","User Reports",3,"breadcrumbItems"],[1,"row"],[1,"col-12"],[1,"card"],[1,"card-body"],[1,"row","mb-2"],[1,"col-sm-4"],[1,"col-sm-8"],[1,"text-sm-end"],["type","button",1,"btn","btn-success","btn-rounded","mb-2","me-2",3,"click"],[1,"mdi","mdi-plus","mr-1"],[1,"table-responsive","mb-0"],[1,"table","table-centered","table-nowrap"],[1,"table"],[1,"align-middle"],[2,"vertical-align","middle"],[4,"ngFor","ngForOf"],[1,"pagination","pagination-rounded","justify-content-end","mb-2"],[3,"totalItems","itemsPerPage","pageChanged"],["colspan","5",1,"text-center"],[1,"form-check","form-switch","form-switch-lg"],["class","badge badge-soft-success font-size-11",4,"ngIf"],["class","badge badge-soft-danger font-size-11",4,"ngIf"],[1,"badge","badge-soft-success","font-size-11"],[1,"badge","badge-soft-danger","font-size-11"]],template:function(e,s){1&e&&(t.YNc(0,lt,1,0,"app-loader",0),t.TgZ(1,"div",1),t._UZ(2,"app-page-title",2),t.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),t._UZ(8,"div",8),t.TgZ(9,"div",9)(10,"div",10)(11,"button",11),t.NdJ("click",function(){return s.exportExcel("Users List")}),t._UZ(12,"i",12),t._uU(13," Export "),t.qZA()()()(),t.TgZ(14,"div",13)(15,"table",14)(16,"thead",15)(17,"tr")(18,"th",16),t._uU(19,"Sl. No."),t.qZA(),t.TgZ(20,"th",16),t._uU(21,"User Name"),t.qZA(),t.TgZ(22,"th",16),t._uU(23,"Contact No"),t.qZA(),t.TgZ(24,"th",16),t._uU(25,"Reg Date"),t.qZA(),t.TgZ(26,"th",16),t._uU(27,"Verification Status"),t.qZA()()(),t.TgZ(28,"tbody",17),t.YNc(29,dt,4,0,"ng-container",0),t.YNc(30,gt,15,9,"ng-container",18),t.qZA()()(),t.TgZ(31,"ul",19)(32,"pagination",20),t.NdJ("pageChanged",function(r){return s.changePage(r)}),t.qZA()()()()()()()),2&e&&(t.Q6J("ngIf",s.showLoader),t.xp6(2),t.Q6J("breadcrumbItems",s.breadCrumbItems),t.xp6(27),t.Q6J("ngIf",!(null!=s.slicedUsersList&&s.slicedUsersList.length)),t.xp6(1),t.Q6J("ngForOf",s.slicedUsersList),t.xp6(2),t.Q6J("totalItems",s.usersList.length)("itemsPerPage",s.itemsPerPage))},dependencies:[g.sg,g.O5,L.Qt,w.V,S.R,g.uU]});const pt=[{path:"users",component:P},{path:"transactions",component:U},{path:"bookings",component:y}];class Z{}Z.\u0275fac=function(e){return new(e||Z)},Z.\u0275mod=t.oAB({type:Z}),Z.\u0275inj=t.cJS({imports:[q.Bz.forChild(pt),q.Bz]});var ht=u(19668);class v{}v.\u0275fac=function(e){return new(e||v)},v.\u0275mod=t.oAB({type:v}),v.\u0275inj=t.cJS({imports:[g.ez,Z,L.u3,k.u5,ht.v]})}}]);